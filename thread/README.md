# Thread

### 학습 순서

- 학습 테스트에서 스레드를 직접 생성해본다.
- 스레드 간에 상태가 어떻게 공유되는지 확인한다.
- 임베디드 톰캣의 스레드의 적절한 설정값을 적용한다.

### 요구 사항

- 스레드를 사용하면서 생길 수 있는 동시성 이슈를 경험해보고 어떻게 해결할 수 있을지 고민해보자.
- 스프링부트에서 톰캣의 스레드를 설정한다.

## 실습

- [x] 0단계 - 스레드 이해하기
- [x] 1단계 - 동시성 이슈 확인하기
- [ ] 2단계 - WAS에 스레드 설정하기

---

corePoolSize : 스레드가 증가된 후 사용되지 않아도 유지될 스레드의 수
maximumPoolSize : 스레드 풀이 관리할 최대의 스레드 수

- newCachedThreadPool()
    - 초기 스레드 : 0
    - corePoolSize : 0
    - maximumPoolSize : Integer.MAX_VALUE (컴퓨터 성능에 따라 다름)

- newFixedThreadPool(int nThreads)
    - 초기 스레드 : 0
    - corePoolSize : nThreads
    - maximumPoolSize : nThreads

- 1단계 상황에 따라 1개 또는 2개가 저장되는 이유
  - 테스트를 그냥 돌리면 두번째 스레드가 먼저 실행되어 저장 후 첫번째 스레드가 실행되어 이미 구구라는 데이터가 있어 저장되지 않는다.
  - 하지만 디버깅을 할 때 if 문을 지나서 브레이크 포인트를 걸면 두번째 스레드가 구구를 저장 하기 전에 잠시 대기를 하고 첫번째 스레드가 if문을 통과할 수 있다.
  - 따라서 두개의 구구 데이터가 저장되는 것이다.
